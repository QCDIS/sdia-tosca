tosca_definitions_version: "tosca_simple_yaml_1_0"
topology_template:
  node_templates:
    compute:
      properties:
        disk_size: "40000 MB"
        mem_size: "4000 MB"
        num_cores: 2
        os_distro: "Ubuntu"
        os_version: "18.04"
        user_name: "vm_user"
      interfaces:
        Standard:
          create: "dumy.yaml"
      type: "tosca.nodes.QC.VM.Compute"
      attributes:
        user_key_pair:
          protocol: "ssh"
          keys:
            public_key: "c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFBZ1FDT0FDM2ZtaWlqanExS1VMbmkwY083MlZzclk3TnBBYWcrZmhGME1BNzc1MkNLVFZseDlwOUhEMnVheUZobk13ZWVXNzFidi9PSEE3a1pjRnQ2MTJPRnlnR09neTBJMnBZTFZJYUgyK1d4d1MxdFF1WTJyS1I3bVFvTG5hWGFyWjBxM3N2c1Y4bStkT2tCWjdMTFpia01yOUFGUzdxWllaZ0VSejdTSURMNmR3PT0gZ2VuZXJhdGVkIHVzZXIgYWNjZWVzIGtleXMK"
            private_key: "LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlDV3dJQkFBS0JnUUNPQUMzZm1paWpqcTFLVUxuaTBjTzcyVnNyWTdOcEFhZytmaEYwTUE3NzUyQ0tUVmx4CjlwOUhEMnVheUZobk13ZWVXNzFidi9PSEE3a1pjRnQ2MTJPRnlnR09neTBJMnBZTFZJYUgyK1d4d1MxdFF1WTIKcktSN21Rb0xuYVhhclowcTNzdnNWOG0rZE9rQlo3TExaYmtNcjlBRlM3cVpZWmdFUno3U0lETDZkd0lEQVFBQgpBb0dBSWhiTzdIQUFzNHNMOU53K1U4SlJ2K1hsS2h4c05KZ3VRSnBaTEZCaE9INEtRZ2xob0tjNUE0RWpMdXhMCnRMS2VjSmpMYzV3NEpVQnlqalhYOER5RzZucTlzVytiRnFuZTVNMmhvTTRsSC9MWkVKRWFnR2F2eGJvOUNEWG0KWDZ2QlZRZ284L0ZPL1NjV29qV2lsamtNUDlHNXA1Y1VRNTV0MTFVOVFZNGJsSGtDUVFER3lrSTI4Q0ZaTWxJWAo0TFdQM1dBU3VBdHY0M0tlTUVYWTEwMC9uaXYzdlgvN2xxNnBRbDRvWnBZakZla0tVOVRldVQ3dU42cmJQeVFvCnlWRnlqd090QWtFQXR0My9PeURFTnBCZ3dwSmFocVRJMnNndVl5QnJyc1pHM2tXY2ZiZXFncUoxSGs1eG9ldGoKeDV0b1FOK3FOYnhCc2FreWZuS0k4bFYyV2t2TlU5b2JNd0pBZCtoS2RtN3ovcVNPeGg1aUJneEhSaU5EcXRMcwpNU1QzREt3WnlYVDBHblJ3dldZUHBzTUVucVA2amVGS2QxTkh4S3pDbTloeU05dHJTVHJkNlJjQTVRSkFMalVLCk9UYWVYZXM5aCt6VFV4SndibGdHNEtWZ2tGa3ByeUNIMm54K2FXUURsQlRlUWJ2cENwY0tVTm96ZUVDSm1RclgKNTN1cGZ4SjVSWGZCK2w0eVlRSkFCM3FCVFZldmpmMTFNM0FQU3plc2ZiL3UzckhrMzY5SG9SeDhEcm1qTjNXZQpGdGxBMnhBd0QwLzhCM1YwVnNxT0JWV2wzTnBVR1JxbXpWbzZjNDNpaWc9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo="
        public_ip: "192.168.10.2"
        role: "master"
        node_type: "t2.medium"
        host_name: "vm0"
    glusterfs:
      type: "tosca.nodes.QC.Application.GlusterFS"
      properties:
        min_masters_num: 1
        min_workers_num: 1
        credentials:
        - { get_attribute: [ compute,user_key_pair ] }
      requirements:
      - host:
          capability: "tosca.capabilities.QC.VM.topology"
          node: "topology"
          relationship: "tosca.relationships.HostedOn"
      interfaces:
        Glusterfs:
          purge:
            inputs:
              repository: "https://github.com/bityoga/mysome_glusterfs.git"
              implementation: 000.purge.yml
              inventory:
                all:
                  children:
                    gfscluster:
                      hosts:
                        gfs1:
                          ansible_host: { get_attribute: [ compute,public_ip ] }
                          ansible_ssh_user: { get_property: [ compute,user_name ] }
    topology:
      properties:
        domain: "Ireland"
        provider: "EC2"
      requirements:
      - vm:
          capability: "tosca.capabilities.QC.VM"
          node: "compute"
          relationship: "tosca.relationships.DependsOn"
      interfaces:
        CloudsStorm:
          delete:
            inputs:
              code_type: "SEQ"
              object_type: "SubTopology"
          hscale:
            inputs:
              code_type: "SEQ"
              object_type: "SubTopology"
          provision:
            inputs:
              code_type: "SEQ"
              object_type: "SubTopology"
          start:
            inputs:
              code_type: "SEQ"
              object_type: "SubTopology"
          stop:
            inputs:
              code_type: "SEQ"
              object_type: "SubTopology"
        Openstack: {}
      type: "tosca.nodes.QC.VM.topology"
      artifacts:
        provisioned_files:
          required: false
          type: "string"

description: "TOSCA example"
imports:
- nodes: "https://raw.githubusercontent.com/qcdis-sdia/sdia-tosca/master/types/nodes.yaml"
- data: "https://raw.githubusercontent.com/qcdis-sdia/sdia-tosca/master/types/data.yml"
- capabilities: "https://raw.githubusercontent.com/qcdis-sdia/sdia-tosca/master/types/capabilities.yaml"
- policies: "https://raw.githubusercontent.com/qcdis-sdia/sdia-tosca/master/types/policies.yaml"
- interfaces: "https://raw.githubusercontent.com/qcdis-sdia/sdia-tosca/master/types/interfaces.yml"
